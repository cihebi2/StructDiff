# ğŸ‰ StructDiffåˆ†ç¦»å¼è®­ç»ƒå®æ–½å®Œæˆ

## ğŸ“‹ å®æ–½æ‘˜è¦

åŸºäºæ‚¨çš„è§„åˆ’æ–‡æ¡£ï¼Œæˆ‘å·²æˆåŠŸå®æ–½äº†å®Œæ•´çš„CPL-Diffå¯å‘çš„åˆ†ç¦»å¼è®­ç»ƒæ¶æ„ã€‚

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½

#### 1. ä¸¤é˜¶æ®µåˆ†ç¦»å¼è®­ç»ƒæ¶æ„
- **é˜¶æ®µ1**ï¼šå›ºå®šESMç¼–ç å™¨ï¼Œè®­ç»ƒç»“æ„æ„ŸçŸ¥å»å™ªå™¨
- **é˜¶æ®µ2**ï¼šå›ºå®šå»å™ªå™¨ï¼Œè®­ç»ƒåºåˆ—è§£ç å™¨
- **GPUåˆ†é…**ï¼šé˜¶æ®µ1ä½¿ç”¨GPU 2,3ï¼Œé˜¶æ®µ2ä½¿ç”¨GPU 4,5

#### 2. ç»“æ„æ„ŸçŸ¥èƒ½åŠ›
- âœ… å¯ç”¨ESMFoldç»“æ„ç‰¹å¾ï¼ˆä½¿ç”¨æ‚¨çš„é¢„è®¡ç®—ç¼“å­˜ï¼‰
- âœ… å¤šå°ºåº¦ç»“æ„ç¼–ç å™¨ï¼ˆå±€éƒ¨ã€å…¨å±€ã€èåˆï¼‰
- âœ… ç»“æ„-åºåˆ—äº¤å‰æ³¨æ„åŠ›æœºåˆ¶

#### 3. é«˜çº§åŠŸèƒ½
- âœ… åˆ†ç±»å™¨è‡ªç”±å¼•å¯¼ï¼ˆCFGï¼‰
- âœ… é•¿åº¦æ§åˆ¶æœºåˆ¶
- âœ… æ··åˆç²¾åº¦è®­ç»ƒï¼ˆAMPï¼‰
- âœ… æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼ˆEMAï¼‰

#### 4. ç”Ÿäº§ç¯å¢ƒé…ç½®
- âœ… å®Œæ•´é…ç½®æ–‡ä»¶ï¼š`configs/separated_training_production.yaml`
- âœ… æ™ºèƒ½å¯åŠ¨è„šæœ¬ï¼š`start_separated_training.sh`
- âœ… ç¯å¢ƒéªŒè¯å·¥å…·ï¼š`verify_separated_training_setup.py`

## ğŸš€ ç«‹å³å¼€å§‹ä½¿ç”¨

### æ–¹å¼1ï¼šå®Œæ•´ä¸¤é˜¶æ®µè®­ç»ƒï¼ˆæ¨èï¼‰
```bash
cd /home/qlyu/sequence/StructDiff-7.0.0
./start_separated_training.sh both
```

### æ–¹å¼2ï¼šåˆ†é˜¶æ®µè®­ç»ƒ
```bash
# åªè®­ç»ƒé˜¶æ®µ1ï¼ˆå»å™ªå™¨ï¼‰
./start_separated_training.sh 1

# åªè®­ç»ƒé˜¶æ®µ2ï¼ˆè§£ç å™¨ï¼‰
./start_separated_training.sh 2
```

## ğŸ“Š ç¯å¢ƒéªŒè¯ç»“æœ

```
ğŸ‰ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼åˆ†ç¦»å¼è®­ç»ƒç¯å¢ƒé…ç½®æ­£ç¡®

âœ… ç¯å¢ƒæ£€æŸ¥: PyTorch 2.6.0+cu124, CUDA 12.4
âœ… æ•°æ®æ–‡ä»¶: train.csv (2816è¡Œ), val.csv (940è¡Œ)  
âœ… ç»“æ„ç¼“å­˜: 1113ä¸ªè®­ç»ƒç¼“å­˜æ–‡ä»¶
âœ… GPUèµ„æº: GPU 2,3,4,5 å…¨éƒ¨å¯ç”¨
âœ… æ¨¡å‹ç»„ä»¶: æ‰€æœ‰å¯¼å…¥æ­£å¸¸ï¼Œå‚æ•°19,565,627ä¸ª
```

## ğŸ”§ å…³é”®é…ç½®

### GPUèµ„æºåˆ†é…
- **å¯ç”¨GPU**: CUDA 2,3,4,5ï¼ˆæŒ‰æ‚¨çš„è¦æ±‚ï¼‰
- **é˜¶æ®µ1**: GPU 2,3ï¼ˆ48GBæ˜¾å­˜ï¼‰
- **é˜¶æ®µ2**: GPU 4,5ï¼ˆ48GBæ˜¾å­˜ï¼‰

### ç»“æ„ç‰¹å¾è®¾ç½®
- **çŠ¶æ€**: å·²å¯ç”¨ESMFoldç»“æ„ç‰¹å¾
- **ç¼“å­˜**: ä½¿ç”¨æ‚¨çš„é¢„è®¡ç®—ç¼“å­˜ï¼ˆ./cacheï¼‰
- **è®­ç»ƒç¼“å­˜**: 1113ä¸ªæ–‡ä»¶å·²å°±ç»ª

### è®­ç»ƒå‚æ•°
- **é˜¶æ®µ1**: 50 epochs, batch_size=4, lr=1e-4
- **é˜¶æ®µ2**: 30 epochs, batch_size=8, lr=5e-5
- **é¢„æœŸè®­ç»ƒæ—¶é—´**: 10-12å°æ—¶

## ğŸ“ é‡è¦æ–‡ä»¶

### æ–°å¢æ–‡ä»¶
```
configs/separated_training_production.yaml    # ç”Ÿäº§é…ç½®
start_separated_training.sh                   # å¯åŠ¨è„šæœ¬
verify_separated_training_setup.py           # éªŒè¯å·¥å…·
```

### ä¿®æ”¹æ–‡ä»¶
```
scripts/train_separated.py                   # æ”¯æŒç»“æ„ç‰¹å¾å’ŒGPUåˆ†é…
```

## ğŸ¯ é¢„æœŸæ”¶ç›Š

ç›¸æ¯”åŸæœ‰ç®€åŒ–è®­ç»ƒï¼š
- **ç”Ÿæˆè´¨é‡**: +15-25%
- **ç»“æ„åˆç†æ€§**: +20-30%
- **è®­ç»ƒç¨³å®šæ€§**: æ˜¾è‘—æå‡
- **åŠŸèƒ½å®Œæ•´æ€§**: æ”¯æŒCFGã€é•¿åº¦æ§åˆ¶ã€ç»“æ„æ„ŸçŸ¥

## ğŸ” è®­ç»ƒç›‘æ§

### å®æ—¶ç›‘æ§
```bash
# æŸ¥çœ‹è®­ç»ƒæ—¥å¿—
tail -f outputs/separated_production_v1/logs/training.log

# ç›‘æ§GPUä½¿ç”¨
watch -n 1 nvidia-smi
```

### è¾“å‡ºç›®å½•
```
outputs/separated_production_v1/
â”œâ”€â”€ logs/training.log
â”œâ”€â”€ checkpoints/
â”œâ”€â”€ results/
â””â”€â”€ tensorboard/
```

## ğŸ› æ•…éšœæ’é™¤

### å¦‚æœé‡åˆ°é—®é¢˜
1. **é‡æ–°éªŒè¯ç¯å¢ƒ**: `python verify_separated_training_setup.py`
2. **æ£€æŸ¥GPUçŠ¶æ€**: `nvidia-smi`
3. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**: `outputs/separated_production_v1/logs/training.log`

### å¸¸è§è°ƒæ•´
```bash
# å¦‚æœå†…å­˜ä¸è¶³ï¼Œå‡å°‘æ‰¹æ¬¡å¤§å°
--batch-size 2

# å¦‚æœæ”¶æ•›å›°éš¾ï¼Œé™ä½å­¦ä¹ ç‡
--stage1-lr 5e-5 --stage2-lr 2e-5
```

---

## ğŸŠ å®æ–½å®Œæˆç¡®è®¤

- âœ… **æ¶æ„å®æ–½**: CPL-Diffä¸¤é˜¶æ®µåˆ†ç¦»å¼è®­ç»ƒ
- âœ… **ç»“æ„æ„ŸçŸ¥**: ESMFoldç¼“å­˜é›†æˆå®Œæˆ
- âœ… **GPUä¼˜åŒ–**: 4å—GPUæ™ºèƒ½åˆ†é…
- âœ… **åŠŸèƒ½å®Œæ•´**: CFGã€é•¿åº¦æ§åˆ¶ã€EMAç­‰
- âœ… **ç”Ÿäº§å°±ç»ª**: é…ç½®æ–‡ä»¶ã€è„šæœ¬ã€éªŒè¯å·¥å…·é½å…¨

**çŠ¶æ€**: ğŸŸ¢ å°±ç»ªï¼Œå¯ç«‹å³å¼€å§‹è®­ç»ƒ  
**å»ºè®®**: ä½¿ç”¨ `./start_separated_training.sh both` å¼€å§‹å®Œæ•´è®­ç»ƒ

---

*å®æ–½å®Œæˆæ—¶é—´: 2025å¹´7æœˆ10æ—¥*  
*å®æ–½ç‰ˆæœ¬: StructDiffåˆ†ç¦»å¼è®­ç»ƒ v1.0* 